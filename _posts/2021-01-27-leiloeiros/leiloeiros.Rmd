---
title: "O jogo dos leiloeiros: quem é o melhor leiloeiro judicial de São Paulo?"
description: Este artigo busca compreender o perfil dos leiloeiros nos processos de falência em São Paulo
author:
  - name: Ricardo Feliz
    url: https://www.linkedin.com/in/ricardo-feliz-okamoto-a20344171/
date: "`r Sys.Date()`"
categories:
  - Falência
  - Leilão
  - Leiloeiro
  - Jurimetria
output:
  distill::distill_article:
    self_contained: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
  warning = FALSE,
  fig.align = "center"
)

options(scipen = 999, digits = 10)

# pacotes necessários
library(tidyverse)

```

```{r}
# 1) Importação
# Import da base de todos os leilões
leiloes <- obsFase3::da_leilao_tidy

cores_abj <- viridis::viridis(2, 1, .2, .8)

```

```{r}
# 2) Arrumação
# a) base principal
analise <- leiloes %>% 
  dplyr::filter(modalidade == "leilao") %>% 
  dplyr::mutate(
    leiloeiro = dplyr::case_when(
      str_detect(leiloeiro, regex("ron.*faro|ron.*mon", ignore_case=TRUE)) ~ "Ronaldo Sérgio Montenegro Rodrigues Faro",
      # Mega Leilões e Fernando José Cerello são a mesma coisa
      str_detect(leiloeiro, regex("Cerello", ignore_case=TRUE)) ~ "Fernando José Cerello Gonçalves Pereira",
      str_detect(leiloeiro, regex("Mega", ignore_case=TRUE)) ~ "Mega Leilões",
      str_detect(leiloeiro, regex("Alexandridis", ignore_case=TRUE)) ~ "Georgios José Ilias Bernabé Alexandridis",
      str_detect(leiloeiro, regex("Moretto", ignore_case=TRUE)) ~ "Gustavo Moretto Guimarães de Oliveira",
      str_detect(leiloeiro, regex("Thais Silva", ignore_case=TRUE)) ~ "Thais Silva Moreira de Sousa",
      str_detect(leiloeiro, regex("Macedo Campos", ignore_case=TRUE)) ~ "André Macedo Campos Toledo",
      str_detect(leiloeiro, regex("Sato", ignore_case=TRUE)) ~ "Antonio Hissao Sato Junio",
      str_detect(leiloeiro, regex("Wendell", ignore_case=TRUE)) ~ "Wendell Marcel Calixto Félix",
      str_detect(leiloeiro, regex("badolato", ignore_case=TRUE)) ~ "Cezar Augusto Badolato Silva",
      str_detect(leiloeiro, regex("Dannae", ignore_case=TRUE)) ~ "Dannae Vieira Avila",
      str_detect(leiloeiro, regex("Dora Plat", ignore_case=TRUE)) ~ "Dora Plat",
      str_detect(leiloeiro, regex("Zukerman", ignore_case=TRUE)) ~ "Fabio Zukerman",
      str_detect(leiloeiro, regex("Samuel", ignore_case=TRUE)) ~ "Gustavo Cristiano Samuel dos Reis",
      str_detect(leiloeiro, regex("Moy", ignore_case=TRUE)) ~ "Renato Schlobach Moysés",
      # Gold Leilões e Uilan Aparecido são a mesma coisa
      str_detect(leiloeiro, regex("Uilian", ignore_case=TRUE)) ~ "Uilian Aparecido da Silva",
      str_detect(cpf_cnpj, "18.067.544/0001-36") ~ "Gold Leilões - Gold Intermediação de Ativos Ltda",
      str_detect(leiloeiro, regex("Villa Nova", ignore_case=TRUE)) ~ "Sérgio Villa Nova de Freitas",
      str_detect(leiloeiro, regex("Boya", ignore_case=TRUE)) ~ "Eduardo Jordão Boyadjian",
      str_detect(leiloeiro, regex("Franklin", ignore_case=TRUE)) ~ "Renata Franklin Simões",
      str_detect(leiloeiro, regex("Cardoso", ignore_case=TRUE)) ~ "Danilo Cardoso da Silva",
      str_detect(leiloeiro, regex("Fidalgo", ignore_case=TRUE)) ~ "Douglas José Fidalgo",
      str_detect(leiloeiro, regex("Affonso", ignore_case=TRUE)) ~ "Alfio Carlos Affonso Zalli Neto",
      str_detect(leiloeiro, regex("casa reis", ignore_case=TRUE)) ~ "Casa Reis Leilões",
      str_detect(leiloeiro, regex("juiz|Furtado|adm|AJ|trustee", ignore_case=TRUE)) ~ "não leiloeiro",
      str_detect(leiloeiro, regex("juiz", ignore_case=TRUE)) ~ "zjuiz",
      str_detect(cpf_cnpj, "15.086.104/0001") ~ "Lance Alienações Eletrônicas Ltda",
      # HastaPublicaBR e Euclides Maraschi Junior são a mesma coisa
      str_detect(cpf_cnpj, "144.470.838-41") ~ "Euclides Maraschi Junior",
      str_detect(cpf_cnpj, "16.792.811/0001-02") ~ "HastaPublicaBR Promotora de Eventos Ltda",
      str_detect(cpf_cnpj, "19.962.222/0001-13") ~ "D1Lance Intermediação de Ativos Ltda",
      str_detect(cpf_cnpj, "537.866.888-34") ~ "Ronaldo Milan", 
    ),
    
    cpf_cnpj = dplyr::case_when(
      leiloeiro == "Ronaldo Sérgio Montenegro Rodrigues Faro" ~ "08046824887",
      leiloeiro == "Fernando José Cerello Gonçalves Pereira" ~ "21989241883",
      leiloeiro == "Georgios José Ilias Bernabé Alexandridis" ~ "25419334879",
      leiloeiro == "Gustavo Moretto Guimarães de Oliveira" ~ " 28034586838",
      leiloeiro == "Thais Silva Moreira de Sousa" ~ " 36171181862",
      leiloeiro == "André Macedo Campos Toledo" ~ "",
      leiloeiro == "Antonio Hissao Sato Junio" ~ "27110999890",
      leiloeiro == "Wendell Marcel Calixto Félix" ~ "16239428884",
      leiloeiro == "Cezar Augusto Badolato Silva" ~ "07538221808",
      leiloeiro == "Dannae Vieira Avila" ~ "36947855829",
      leiloeiro == "Dora Plat" ~ "07080906806",
      leiloeiro == "Fabio Zukerman" ~ "21575323826",
      leiloeiro == "Gustavo Cristiano Samuel dos Reis" ~ "27358397886",
      leiloeiro == "Renato Schlobach Moysés" ~ "09141676858",
      leiloeiro == "Uilian Aparecido da Silva" ~ "11645230821",
      leiloeiro == "Sérgio Villa Nova de Freitas" ~ "33201862800",
      leiloeiro == "Eduardo Jordão Boyadjian" ~ "12634759819",
      leiloeiro == "Renata Franklin Simões" ~ "20538037890",
      leiloeiro == "Danilo Cardoso da Silva" ~ "31191072800",
      leiloeiro == "Alfio Carlos Affonso Zalli Neto" ~ " 39681014804",
      leiloeiro == "Douglas José Fidalgo" ~ "16499659827",
      leiloeiro == "Mega Leilões" ~ "03122040000102",
      leiloeiro == "Casa Reis Leilões" ~ " 19116554000187",
      leiloeiro == "Lance Alienações Eletrônicas Ltda" ~ "15086104000138",
      leiloeiro == "Euclides Maraschi Junior" ~ "14447083841",
      leiloeiro == "HastaPublicaBR Promotora de Eventos Ltda" ~ "16792811000102",
      leiloeiro == "Gold Leilões - Gold Intermediação de Ativos Ltda" ~ "18067544000136",
      leiloeiro == "D1Lance Intermediação de Ativos Ltda" ~ "19962222000113",
      leiloeiro == "Ronaldo Milan" ~ "53786688834",
      TRUE ~ cpf_cnpj
    ),
    
    id_leiloeiro = dplyr::case_when(
      leiloeiro == "Ronaldo Sérgio Montenegro Rodrigues Faro" ~ "6331",
      leiloeiro == "Fernando José Cerello Gonçalves Pereira" ~ "5406",
      leiloeiro == "Georgios José Ilias Bernabé Alexandridis" ~ "7633",
      leiloeiro == "Gustavo Moretto Guimarães de Oliveira" ~ "7979",
      leiloeiro == "Thais Silva Moreira de Sousa" ~ "34064",
      leiloeiro == "André Macedo Campos Toledo" ~ "",
      leiloeiro == "Antonio Hissao Sato Junio" ~ "858",
      leiloeiro == "Wendell Marcel Calixto Félix" ~ "23601",
      leiloeiro == "Cezar Augusto Badolato Silva" ~ "5393",
      leiloeiro == "Dannae Vieira Avila" ~ "28025",
      leiloeiro == "Dora Plat" ~ "5608",
      leiloeiro == "Fabio Zukerman" ~ "5508",
      leiloeiro == "Gustavo Cristiano Samuel dos Reis" ~ "5596",
      leiloeiro == "Renato Schlobach Moysés" ~ "466",
      leiloeiro == "Uilian Aparecido da Silva" ~ "26542",
      leiloeiro == "Sérgio Villa Nova de Freitas" ~ "5604",
      leiloeiro == "Eduardo Jordão Boyadjian" ~ "924",
      leiloeiro == "Renata Franklin Simões" ~ "669",
      leiloeiro == "Danilo Cardoso da Silva" ~ "7794",
      leiloeiro == "Alfio Carlos Affonso Zalli Neto" ~ "21977",
      leiloeiro == "Douglas José Fidalgo" ~ "5535",
      leiloeiro == "Mega Leilões" ~ "5426",
      leiloeiro == "Casa Reis Leilões" ~ " 5448",
      leiloeiro == "Lance Alienações Eletrônicas Ltda" ~ "5937",
      leiloeiro == "Euclides Maraschi Junior" ~ "5665",
      leiloeiro == "HastaPublicaBR Promotora de Eventos Ltda" ~ "1057",
      leiloeiro == "Gold Leilões - Gold Intermediação de Ativos Ltda" ~ "620",
      leiloeiro == "D1Lance Intermediação de Ativos Ltda" ~ "5366",
      leiloeiro == "Ronaldo Milan" ~ "29112",
      TRUE ~ id_leiloeiro
    )
  ) %>% 
  # Tratamento dos lotes
  mutate(descricao = stringr::str_remove_all(descricao, stringr::regex("lote *(nº *)?[0-9.]+ *[:;-–]? *(?=[a-z0-9- ]{1,5})", TRUE))) %>% 
  # Equivalência de leiloeiros
  mutate(leiloeiro_pj = case_when(str_length(cpf_cnpj) >= 14 ~ leiloeiro)) %>%
  mutate(leiloeiro_pf = case_when(
    str_length(cpf_cnpj) < 14 ~ leiloeiro,
    leiloeiro == "Mega Leilões" ~ "Fernando José Cerello Gonçalves Pereira",
    leiloeiro == "HastaPublicaBR Promotora de Eventos Ltda" ~ "Euclides Maraschi Junior",
    leiloeiro == "Gold Leilões - Gold Intermediação de Ativos Ltda" ~ "Uilian Aparecido da Silva",
    leiloeiro == "Casa Reis Leilões" ~ "Eduardo dos Reis",
    leiloeiro == "D1Lance Intermediação de Ativos Ltda" ~ "Dannae Vieira Avila"
  )) %>% 
  mutate(leiloeiro_usar = case_when(
    !is.na(leiloeiro_pf) ~ leiloeiro_pf,
    is.na(leiloeiro_pf) ~ leiloeiro_pj
  )) %>% 
  filter(!is.na(leiloeiro))

# b) sub-base PROCESSO
processos <- analise %>% 
  select(!leiloeiro) %>% 
  rename(leiloeiro = leiloeiro_usar) %>% 
  dplyr::group_by(id_processo, leiloeiro) %>% 
  dplyr::summarise(valor_total_processo = sum(valor_avaliacao_inicial, na.rm=T)) %>% 
  group_by(leiloeiro) %>% 
  summarise(qtd_processos = n(), vtp = mean(valor_total_processo, na.rm=T)) %>% 
  arrange(desc(qtd_processos)) %>% 
  filter(vtp > 100)

# c) sub-base SUCESSO

sucesso <- analise %>% 
  select(!leiloeiro) %>% 
  rename(leiloeiro = leiloeiro_usar) %>% 
  filter(leiloeiro != "Lance Alienações Eletrônicas Ltda") %>% 
  arrange(desc(data_edital)) %>% 
  group_by(id_processo, descricao) %>% 
  slice(1) %>% 
  select(id_processo, descricao, leiloeiro, valor_avaliacao_inicial, vendeu, valor_total_arrematado) %>%
  filter(is.na(valor_avaliacao_inicial) | valor_avaliacao_inicial > 0) %>%
  mutate(across(
    .cols = contains("valor"),
    .fns = ~case_when(is.na(.x) ~ 0,
           TRUE ~ .x)
  )) %>%
  mutate(vendeu = case_when(
    is.na(vendeu) ~ "nao", 
    TRUE ~ vendeu
  )) %>% 
  mutate(taxa_venda_valor = valor_total_arrematado / valor_avaliacao_inicial) %>% 
  filter(taxa_venda_valor <= 10)
```

# Introdução

Sempre que uma empresa entra em falência, se inicia um procedimento de arrecadação dos ativos. Essa arrecadação pode levantar desde plásticos triturados, avaliados em R\$ 1,00 (um real), até imóveis de R\$ 157.000.000,00 (157 milhões de reais). Independente do valor, esses bens na maioria dos casos vão para leilão. E no leilão, há sempre algum responsável por alienar esses bens. O responsável é o leiloeiro. Esse leiloeiro irá determinar as condições de venda dos bens, o que envolve definir (1) se eles serão vendidos em lotes, agrupando vários bens em uma única venda, ou individualmente; (2) o valor mínimo que os bens poderão ser vendidos; (3) a data do leilão; (4) a modalidade do leilão (presencial, eletrônico ou ambos); (5) o lance mínimo, entre outras condições. O importante de notar é que cada leiloeiro possui certa discricionariedade para agir, pois há algumas escolhas que ele deverá realizar em cada leilão, ao definir as condições de arrematação dos bens. 

Se há várias estratégias possíveis para os leiloeiros utilizarem, então podemos dizer que alguns profissionais poderão realizar melhores escolhas do que outros. Assim, o que esse artigo busca é tentar definir qual leiloeiro foi mais bem sucedido nos leilões relacionados aos processos de falência de São Paulo.

A base que utilizaremos para tanto é uma das bases de dados da 3ª fase do Observatório da Insolvência da ABJ[^labelfoot], isto é, o observatório das falências em São Paulo. Mais especificamente, utilizaremos a base que contém todos os bens que foram a leilão, em SP. Cada observação é um bem diferente. E cada coluna é uma característica desse bem. As principais características que utilizaremos aqui são: o processo no qual esse bem se encontra; o leiloeiro responsável pela alienação desse bem; o valor de avaliação dos bens; a informação de se o bem vendeu ou não; e o preço pelo qual o bem foi arrematado. 

[^labelfoot]: O observatório da insolvência é uma iniciativa do Núcleo de Estudos de Processos de Insolvência - NEPI da PUC-SP e da Associação Brasileira de Jurimetria – ABJ e tem o objetivo de levantar e analisar dados a respeito das empresas em crise que se dirigem ao Poder Judiciário para viabilizar meios de recuperação ou, em último caso, para serem liquidadas. Trata-se de um projeto incremental, que se iniciou com o estudo dos processos de recuperação judicial e que, nessa etapa, expandiu seu escopo para todos processos de falências do Estado de São Paulo. O estudo tem lançamento previsto para 2021.

Com base nesses dados, podemos pensar em estratégias para determinar o sucesso dos leiloeiros. Essa comparação será feita  colocando os leiloeiros para jogar diversos jogos entre si, disputando os melhores scores em cada jogo. Veremos a seguir as regras dos jogos. 

# As regras dos jogos

### Dos candidatos habilitados

A única regra para a habilitação dos leiloeiros nos jogos é que eles sejam pessoas físicas. A base original continha algumas pessoas jurídicas. Entretanto, muitas dessas pessoas jurídicas estavam associadas a um único leiloeiro, sendo possível, portanto, substituir a pessoa jurídica por uma pessoa física facilmente. Isso aconteceu para o "Mega Leilões", "Gold Leilões", "D1 Lance", "Hasta Pública" e "Casa Reis". A tabela a seguir indica a relação entre as pessoas jurídicas e os respectivos leiloeiros por detrás delas. 

::: l-body
|Pessoa jurídica|Leiloeiro|
|:--------------|:--------|
|Mega Leilões|Fernando José Cerello Gonçalves Pereira|
|Hasta Publica BR|Euclides Maraschi Junior|
|Gold Leilões|Uilian Aparecido da Silva|
|Casa Reis Leilões|Eduardo dos Reis|
|D1 Lance|Dannae Vieira Avila|
:::

Houve uma casa de leilões, entretanto, que não havia uma pessoa física correspondente. Foi a casa Lance Alienações Eletrônicas Ltda. Este, portanto, foi o único candidato desqualificado.

Ao fim, ficamos com 24 concorrentes.

### Dos jogos

Ao todo serão feitos 4 jogos. Em cada jogo, os leiloeiros irão marcar pontos. O jogador que obtiver mais pontos ao final dos 4 jogos será o vencedor. 

### Da contagem dos pontos

Para cada um dos jogos, podemos ordenadar os leiloeiros. Cada um dos jogos possui bases diferentes de pontuação. Por exemplo, no jogo 1, os jogadores podem fazer de 0 a 135 pontos, mas no jogo 3, os jogadores podem fazer só de 0 a 1 pontos. O problema é que dessa forma, o ganhador do jogo 1 teria mais vantagem do que o ganhador do jogo 3. Para resolver este problema, padronizamos as pontuações, de modo que a colocação de um jogador se tornou a sua pontuação em cada um dos jogos.  

Como há 24 concorrentes, a pontuação máxima que alguém pode fazer em cada um dos jogos é de 24 pontos e a mínima, de 1 ponto. Entretanto, nem sempre teremos alguém pontuando 24 pontos, pois, quando dois ou mais leiloeiros empatam entre si, eles recebem a mesma pontuação. O fato de nem todos os jogos chegarem a 24 pontos pode privilegiar alguns jogos, em detrimento de outros. Assim, esses pontos serão normalizados, ou seja, eles serão divididos pelo número de pontos do primeiro lugar. 

Ao fim dos 4 jogos, as pontuações serão somadas, para criarmos um placar final. Então o jogador que acumular mais pontos ao fim dos 4 jogos será o vencedor. 

### Do prêmio

Os leiloeiros que ficarem em 1º, 2º e 3º lugares irão receber uma menção especial ao final deste post. 

# Que comecem os jogos!

## Jogo 1: Coletando leilões

O primeiro jogo é o **Coletando leilões**. Este jogo funciona da seguinte maneira: o juiz irá escolher algum leiloeiro de sua confiança para realizar o leilão. O leiloeiro que conseguir mais processos, será o vencedor. Há um total de 135 processos com leilões. Então o máximo de leilões que alguém pode acumular é 135, e o mínimo é 1.

``` {r plot1, eval = TRUE, layout="l-body-outset"}
media1 <- mean(processos$qtd_processos)

processos %>% 
  mutate(leiloeiro = forcats::fct_reorder(leiloeiro, qtd_processos)) %>% 
  ggplot() +
    geom_col(mapping = aes(x = qtd_processos, y = leiloeiro), fill=cores_abj[1]) +
    geom_vline(xintercept=media1, size=.5, color="red") + 
    labs(x="quantidade de processos", y="leiloeiros") +
    theme_minimal()
```

No primeiro jogo, de número de processos que cada leiloeiro recebeu, tivemos um destaque fortíssimo. Fernando José Cerello Gonçalves Pereira assumiu a liderança com quase 40 processos ! O segundo lugar foi Ronaldo Faro, com 28 processos, e o terceiro colocado foi Renato Schlobach Moysés, com 24 processos. O quarto lugar teve apenas 12 processos em sua contagem, e foi Thays Silva Moreira de Sousa. Os próximos jogadores, não passaram de 10 processos, e a moda foi de apenas 1 processo! 

Com isso, o placar ficou:

```{r placar1, eval=TRUE, results='asis'}
placar1 <- processos %>% 
  mutate(score_jogo_1 = as.numeric(forcats::as_factor(qtd_processos))) %>%
  mutate(score_jogo_1 = score_jogo_1 / 9) %>% # o valor máximo foi 9
  select(leiloeiro, qtd_processos, score_jogo_1) %>% 
  arrange(desc(score_jogo_1))

placar1 %>% 
  knitr::kable(digits=2, col.names = gsub("[_]", " ", names(placar1))) %>% 
  kableExtra::scroll_box(height = "500px", width = "550px")
```

Como houve muitos candidatos empatados, o primeiro lugar de Fernando rendeu-lhe apenas 9 pontos. 

## Jogo 2: O tamanho do peixe

O segundo jogo é **O tamanho do peixe**. Este jogo busca comparar, não a quantidade de processos de cada leiloeiro, mas o valor médio dos leilões que lhes foi confiado. Para isso, calculamos o valor total de cada um dos processos e dividimos pelo total de bens. Ganha quem tiver um valor médio por processo maior. 

```{r plot2, eval = TRUE, layout="l-body-outset"}
media2 <- mean(processos$vtp)

processos %>% 
  mutate(leiloeiro = forcats::fct_reorder(leiloeiro, vtp)) %>% 
  ggplot() +
    geom_col(mapping = aes(x = vtp, y = leiloeiro), fill=cores_abj[1]) +
    geom_vline(xintercept = media2, size=.5, color="red") +
    scale_x_log10(labels = scales::label_number_si(), breaks = 10^c(1:8)) +
    labs(x = "valor médio por processo", y="leiloeiros") +
    theme_minimal()
```

No segundo jogo, o primeiro lugar saiu disparado na frente, com a incrível quantidade de R\$ 86.608.346,88 por processo (86 milhões de reais por processo). O ganhador foi Euclides Maraschi Junior. A disputa pelo segundo lugar foi acirradíssima. Por pouco, Fernando José Cerello ganhou de Renato Schlobach Moysés. O valor médio de seus processos foi, respectivamente, de R\$ 29.938.436,60 (29 milhões) por proceso e de R\$ 26.053.257,72 (26 milhões). Os últimos colocados tiveram arrecadações de 300 mil até 25 mil reais por processo. É uma diferença na escala de 100 vezes em relação aos primeiros colocados. 

No fim, o placar ficou:

```{r placar2, eval=TRUE, results='asis'}
preplacar2 <- processos %>% 
  mutate(score_jogo_2 = as.numeric(forcats::as_factor(vtp))) %>% 
  mutate(score_jogo_2 = score_jogo_2 / 24) %>% # o valor máximo foi 24
  select(leiloeiro, vtp, score_jogo_2) %>% 
  arrange(desc(score_jogo_2))

placar2 <- left_join(placar1, preplacar2, by = "leiloeiro") %>% 
  mutate(pontos_acumulados = score_jogo_1 + score_jogo_2) %>%
  select(leiloeiro, vtp, score_jogo_2, score_jogo_2, pontos_acumulados) %>%
  rename(valor_medio_processo = vtp) %>%
  mutate(valor_medio_processo = formattable::currency(
    valor_medio_processo, "R$", big.mark = ".", decimal.mark = ","
  )) %>% 
  arrange(desc(score_jogo_2))

knitr::kable(placar2, digits=2, col.names = gsub("[_]", " ", names(placar2))) %>%
  kableExtra::scroll_box(height = "500px", width = "100%")
```

Esta disputa rendeu incríveis 24 pontos para Euclides ! Mas isso não foi suficiente para ultrapassar Fernando, nem Renato, que no placar geral estão respectivamente, com 6 e 3 pontos na frente de Euclides. 

## Jogo 3: Quem vende mais?

O terceiro jogo é **Quem vende mais?**. Este jogo (e o próximo também) está olhando, não para características dos leilões que foram encaminhados a cada um dos leiloeiros, mas para os resultados desses leilões. Assim, o que está sendo comparado aqui é o que chamaremos de "taxa_sucesso". É uma conta simples: de todos os bens que poderiam ter sido vendidos, quantos de fato conseguiram ser alienados? Essa taxa é um valor de 0 a 1. O leiloeiro que obtiver a maior taxa será o ganhador. 

```{r plot3, eval = TRUE, layout="l-body-outset"}
jogo3 <- sucesso %>% 
  group_by(leiloeiro, vendeu) %>%
  summarise(qtd_bens = n()) %>% 
  tidyr::pivot_wider(
    names_from = vendeu,
    values_from = qtd_bens
  ) %>% 
  mutate(across(
    c(sim, nao),
    ~replace_na(.x, 0)
  )) %>% 
  mutate(total_bens = sim + nao, taxa_sucesso = sim / total_bens) %>% 
  ungroup(leiloeiro) %>% 
  mutate(leiloeiro = forcats::fct_reorder(leiloeiro, taxa_sucesso))
  
media3 <- mean(jogo3$taxa_sucesso)

ggplot(jogo3) + 
  geom_col(mapping = aes(x = taxa_sucesso, y = leiloeiro), fill=cores_abj[1]) +
  geom_vline(xintercept=media3, size=.5, color="red") +
  labs(x="taxa de sucesso", y="leiloeiros") +
  theme_minimal()
```

O terceiro jogo foi o mais disputado até agora. Tivemos 3 leiloeiros empatados em primeiro lugar, todos com uma taxa de sucesso de 1 ponto ! Quem se deu melhor nessa competição foram aqueles que tinham poucos bens para alienar. Com poucos bens era fácil vender tudo. E aqueles com muitos bens tiveram dificuldades em vender tudo. Mas na verdade, ter poucos bens também mostrou um enorme risco: o peso individualmente de um único bem, caso ele não fosse alienado, mostrou-se devastador para os competidores, pois a taxa de sucesso dispencava. Foi o caso de Dora Plat e de Danilo Cardoso, que ficaram com uma taxa de sucesso de 0. Danilo tiha apenas 9 bens para alienar; e Dora, 30. Esse jogo embaralhou bastante a competição, deixando bem mais acirrada a disputa no placar geral. 

```{r placar3, eval=TRUE, results='asis'}
preplacar3 <- jogo3 %>% 
  mutate(score_jogo_3 = as.numeric(forcats::as_factor(taxa_sucesso))) %>%
  mutate(score_jogo_3 = score_jogo_3 / 18) %>% # o valor máxim foi 18
  select(leiloeiro, taxa_sucesso, score_jogo_3) %>% 
  arrange(desc(score_jogo_3))

placar3 <- left_join(preplacar3, placar2, by = "leiloeiro") %>% 
  mutate(pontos_acumulados = pontos_acumulados + score_jogo_3) %>%
  select(leiloeiro, taxa_sucesso, score_jogo_3, pontos_acumulados) %>% 
  arrange(desc(score_jogo_3))

knitr::kable(placar3, digits=2, col.names = gsub("[_]", " ", names(placar3))) %>% 
  kableExtra::scroll_box(height = "500px", width = "100%")

```

A liderança está agora com Renato Scholbach Moysés, mas apenas 2 pontos atrás está Alfio Carlos Affonso Zalli Neto. Será que Renato conseguirá manter sua posição no último jogo? 

## Jogo 4: Quem dá mais?

O quarto e último jogo é **Quem dá mais?**. O que vai ser comparado é, não a taxa de bens vendidos, mas o valor pelos quais esses bens foram vendidos. Para cada bem alienado, foi calculada uma taxa de venda através da operação *valor vendido / valor de avaliação*. Essa taxa, na base de dados, variou de 0 (quando o bem não havia sido alienado) até 10 (quando o bem havia sido vendido por 10 vezes o preço de avaliação). Alguns bens ficaram com uma taxa de venda de infinito, mas isso ocorreu devido ao fato de que tais bens haviam sido avaliados em R$ 0,00 (zero reais). Dessa forma, realizou-se uma divisão por zero. Esses bens foram excluídos da análise. Além disso, como os bens não vendidos já foram considerados no jogo passado, para não prejudicar duplamente os leiloeiros, consideramos para este jogo apenas os bens vendidos. Assim, todos os bens cuja taxa de venda era igual a 0 foram filtrados e retirados. Com essa alteração, todos os leiloeiros que no jogo passado não venderam nenhum bem acabaram sendo desqualificados do jogo, ficando em último lugar. 

A partir desta avariável, foi possível criar o critério de comparação deste jogo: a taxa média de venda. Esse critério buscou comparar a taxa média por que cada leiloeiro conseguia alienar os bens. A seguir, temos os resultados da competição. 

```{r plot4, eval = TRUE, layout="l-body-outset"}
jogo4 <- sucesso  %>% 
  filter(vendeu == "sim") %>% 
  group_by(leiloeiro) %>% 
  summarise(taxa_venda_media = mean(taxa_venda_valor)) %>% 
  mutate(leiloeiro = forcats::fct_reorder(leiloeiro, taxa_venda_media))

media4 <- mean(jogo4$taxa_venda_media)

ggplot(jogo4) +
  geom_col(mapping = aes(y = leiloeiro, x = taxa_venda_media), fill=cores_abj[1]) +
  geom_vline(xintercept = media4, size=.5, color="red") +
  labs(x="taxa de venda média",y="leiloeiros") +
  theme_minimal()
```

Vemos, acima que este jogo foi difícil para os leiloeiros com grandes valores de bens em suas mãos, pois aqui o valor inicial contava muito. Não bastava que os bens simplesmente fossem vendidos, eles precisavam ser vendidos pelo maior valor possível. Em média, os leiloeiros conseguiam vender a uma taxa de  

Muitos candidatos foram desclassificados neste jogo, pois eles não conseguiram vender nenhum bem. Dos que ficaram, era possível que eles vendessem seus bens por taxas de venda maiores que 1, entretanto, o único que conseguiu ter um taxas de venda média maior do que 1 foi Cezar Augusto Badolato. Com isso, temos consolidado o placar final. 

```{r placar4, eval=TRUE, results='asis'}
preplacar4 <- sucesso %>% 
  group_by(leiloeiro) %>% 
  summarise(taxa_venda_media = mean(taxa_venda_valor)) %>%
  arrange(taxa_venda_media) %>% 
  mutate(score_jogo_4 = as.numeric(forcats::as_factor(taxa_venda_media))) %>%
  mutate(score_jogo_4= score_jogo_4 / 23) %>% # o máximo foi 23
  select(leiloeiro, taxa_venda_media, score_jogo_4) %>% 
  arrange(desc(score_jogo_4))

placar4 <- left_join(preplacar4, placar3, by = "leiloeiro") %>% 
  mutate(pontos_acumulados = pontos_acumulados + score_jogo_4) %>%
  select(leiloeiro, taxa_venda_media, score_jogo_4, pontos_acumulados) %>% 
  arrange(desc(score_jogo_4))

knitr::kable(placar4, digits=2, col.names = gsub("[.]", " ", names(placar4))) %>% 
  kableExtra::scroll_box(height = "500px", width = "100%")
```

# E o ganhador é... 

Computando todos os jogos, temos o seguinte resultado:

```{r, eval=TRUE, results='asis'}
placar_final <- left_join(preplacar4, left_join(preplacar3, left_join(preplacar2, placar1, by = "leiloeiro"), by = "leiloeiro"), by = "leiloeiro") %>% 
  mutate(pontos_acumulados = score_jogo_1 + score_jogo_2 + score_jogo_3 + score_jogo_4) %>% 
  mutate(colocacao_final = forcats::as_factor(pontos_acumulados)) %>% 
  mutate(colocacao_final = fct_rev(colocacao_final)) %>% 
  mutate(colocacao_final = as.numeric((colocacao_final))) %>% 
  arrange(colocacao_final) %>% 
  select(leiloeiro, score_jogo_1, score_jogo_2, score_jogo_3, score_jogo_4, pontos_acumulados, colocacao_final) %>% 
  rename(jogo_1 = score_jogo_1,
         jogo_2 = score_jogo_2,
         jogo_3 = score_jogo_3,
         jogo_4 = score_jogo_4)

placar_final %>% 
  knitr::kable(digits=2, col.names = gsub("[_]", " ", names(placar_final))) %>% 
  kableExtra::row_spec(1:3, bold=TRUE, background=cores_abj[2]) %>% 
  kableExtra::scroll_box(height = "500px", width = "100%")

```


Menção especial aos vencedores: o vencedor é **GUSTAVO CRISTIANO SAMUEL DOS REIS**, com 60 pontos. Em segundo lugar, com apenas 1 ponto de diferença, temos *CEZAR AUGUSTO BADOLATO SILVA*. E em terceiro lugar, com 5 pontos a menos que o primeiro lugar, temos ALFIO CARLOS AFFONSO ZALLI NETO. 

Parabéns a todos os participantes. 

### Considerações metodológicas 

Até aqui, assumi um tom informal para apresentar os dados sobre os leiloeiros de São Paulo. Esta escolha foi feita, pensando em divulgar estes dados de uma forma lúdica e acessível a qualquer leitor. Entretanto, essa escolha sacrificou, em alguns momentos, um rigor técnico-cientfíco importante. Nestas considerações finais, pretendo fazer algumas ressalvas sobre os resultados obtidos. 

As ressalvas dizem respeito ao que significa ser ganhador desta competição. O ponto que quero deixar claro é que o sucesso de um leiloeiro não necessariamente está ligado aos seus próprios esforços. Pela narrativa da "competição" que eu criei para apresentar os dados, poderia dar a entender que os leiloeiros ganhadores são aqueles que se esforçaram mais para ganhar e, portanto, são _os melhores_ leiloeiros. Entretanto, o que eu preciso deixar claro é que o sucesso dos leiloeiros em cada um dos jogos envolvia fatores que estavam muito além das vontades e capacidades de cada jogador. Vejamos caso a caso onde estavam as limitações. 

Primeiro, no **jogo 1 (quantidade de processos)**, a quantidade de processos que um leiloeiro recebe está atrelada, no fim das contas, à escolha de um agente externo. O leiloeiro tem algum mérito em ser escolhido na medida em que o juiz escolhe alguém de sua confiança. O **jogo 2 (valor dos leilões)** padece do mesmo problema, pois não só o leiloeiro não escolhe a quantos processos ele é chamado, como ele também não escolhe o valor total de cada processo que lhe chega. É claro que há uma escolha, pequena, do leiloeiro ao ser chamado a um processo, pois ele pode rejeitar a oferta de realizar leilões de pequenos valores e aceitar apenas processos de grandes montas. Entretanto, o que me interessa aqui é que, à rigor, o valor do processo não é algo determinado pelo leiloeiro, mas é uma circunstância do processo, determinada externamente a ele. 

Nos **jogos 3 (taxa de sucesso)** e **4 (taxa de venda)**, há um problema parecido. Neles, persiste a questão de que o sucesso do leiloeiro é determinado por um agente externo, mas neste caso, o elemento externo são os "clientes" dos leilões, isto é, os arrematantes. Basicamente, o sucesso ou não da alienação dos bens depende mais da vontade de alguém em comprá-los, do que os esforços do leiloeiro. Apenas em parte o leiloeiro é responsável pelo sucesso da venda dos bens. O mérito (ou não) dos leiloeiros na venda dos bens pode ser que, ou ele tenha colocado um preço mínimo de venda muito alto, o que afastou alguns clientes (e, portanto, diminuiu a sua taxa de sucesso total); ou ele colocou um preço baixo demais, arrecadando menos do que ele poderia ter arrecadado (e, portanto, diminuiu a taxa de venda dos bens).

Feitos esses esclarecimentos, posso encerrar o artigo com algumas conclusões gerais. 

### Considerações finais

Os jogos entre os leiloeiros foram úteis para demonstrar que... 
- Desigualdade entre leiloeiros
- Valores altos
- Recuperabilidade

