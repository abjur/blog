---
title: "Justiça e desenvolvimento: a relação entre a litigiosidade e o desenvolvimento"
description: |
  Este artigo busca investigar se existe uma relação entre a taxa de litigiosidade com o desenvolvimento. Para tanto, utilizamos uma base de dados com todos os processos que apareceram no Diário Oficial da União em cada município brasileiro e cruazamos tais informações com a base de dados do PNUD (Programa das Nações Unidas para o Desenvolvimento). A hipótese inicial era a de que quanto maior o desenvolvimento de um município, maior é a complexidade da sociedade, o que gera mais conflitos. Esses conflitos se traduzem em processos judicias, o que é expresso pela litigiosidade. Daí a relação entre desenvolvimento e litigiosidade. 
author:
  - name: João Torquato
    url: https://www.linkedin.com/in/jo%C3%A3o-marcelo-torquato-157b0a16a/  
  - name: Julio Trecenti
    url: https://www.linkedin.com/in/jtrecenti/
  - name: Katerine Witkoski
    url: https://www.linkedin.com/in/katerine-witkoski-53b19518b/
  - name: Ricardo Feliz
    url: https://www.linkedin.com/in/ricardo-feliz-okamoto-a20344171/
date: "`r Sys.Date()`"
categories:
  - Analises
  - Justiça
  - Desenvolvimento
  - Litigiosidade
output:
  distill::distill_article:
    self_contained: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = FALSE, 
  message = FALSE, 
  warning = FALSE,
  fig.align = "center"
)

options(scipen = 999)

# carrega pacotes necessários
library(tidyverse)
library(patchwork)
```

```{r}
# 1) Importação
# a) carrega base `da_contagens` disponivel no pacote djprocPublic
da_contagens <- djprocPublic::da_contagens

# b) carrega base 'pnud_min" disponível no pacote abjData
base_pnud <- abjData::pnud_min
```

```{r}
# 2) Arrumação
base1 <- da_contagens %>%
  filter(!is.na(codigo_ibge)) %>%
  filter(ano == "2010") %>%
  group_by(codigo_ibge) %>%
  summarize(qtd_processos = sum(n))

base2 <- base_pnud %>%
  rename(codigo_ibge = muni_id) %>%
  filter(ano == "2010")

# Base principal
base_litigiosidade <-
  inner_join(base1, base2, by = "codigo_ibge") %>%
  # Criando taxa de litigiosidade
  mutate(taxa = round(((qtd_processos / pop) * 100), 3))

```

## Introdução

### Definição do problema

Quanto mais desenvolvimento, mais complexa é a sociedade, mais contratos são celebrados. Isso deve gerar maior litigância. Portanto, existe uma relação entre desenvolvimento e litigiosidade. No texto fazemos uma análise sobre o volume de processos em razão as regiões do Brasil. 

## Metodologia

### Origem das bases de dados

### Descrição das bases

### Alterações nas bases

## Resultados

A tabela mostra os 10 municípios (comarcas) com maiores taxas de ligiosidade. 

```{r,  eval = TRUE, echo = FALSE}
base_litigiosidade %>%
  dplyr::select(muni_nm, taxa) %>%
  dplyr::top_n(10, taxa) %>%
  dplyr::arrange(taxa) %>%
  dplyr::rename("Taxa de litigiosidade" = taxa, "Município" = muni_nm) %>%
  knitr::kable(caption = "10 municípios (comarcas) com maiores taxas de litigiosidade")
```

A tabela mostra as comarcas 5 municípios (comarcas) com maiores taxas de litigiosidade (Por região)

```{r,  eval = TRUE, echo = FALSE}
base_litigiosidade %>%
  dplyr::arrange(dplyr::desc(taxa)) %>%
  dplyr::distinct(regiao_nm, .keep_all = TRUE) %>%
  dplyr::select(regiao_nm, muni_nm, taxa) %>%
  dplyr::rename(
    "Taxa de litigiosidade" = taxa,
    "Município" = muni_nm,
    "Região" = regiao_nm
  ) %>%
  knitr::kable(caption = "5 municípios (comarcas) com maiores taxas de litigiosidade (Por região)")
```

### Taxa de litigiosidade por IDHM.

Gráfico de litigiosidade x idhm geral (terminar)

```{r fig.cap = "Litigiosidade por IDHM", layout="l-body-outset", eval = TRUE, echo = FALSE, warning = FALSE}

base_litigiosidade %>%
  dplyr::select(idhm, taxa) %>%
  ggplot2::ggplot(
    aes(x = idhm,  y = taxa))+
  ggplot2::scale_y_log10() +
  ggplot2::geom_point(color = "#102C68", size = 1)  +
  labs(x = "IDHM",
       y = "Taxa de litigiosidade")

```
A figura  mostra a taxa de litigiosidade por IDHM educação entre as regiões do Brasil. 

```{r fig.cap = "Litigiosidade por IDHM educação", layout="l-body-outset", eval = TRUE, echo = FALSE, warning = FALSE}
# Padrão de cor para o gráfico
green_abj <- viridis::viridis(2, 1, .2, .8)[2]
# cria a média da taxa
media_taxa <- mean(base_litigiosidade$taxa)

base_litigiosidade %>%
  dplyr::select(idhm_e, taxa, regiao_nm) %>%
  dplyr::mutate(taxa_log = log(taxa)) %>% # Taxa em log
  ggplot2::ggplot(aes(x = idhm_e,  y = taxa_log)) +
  ggplot2::geom_hline(
    yintercept = media_taxa,
    size = .5,
    colour = "red",
    linetype = 2
  ) +
  ggplot2::geom_point(color = "#102C68", size = .5)  +
  labs(x = "IDHM Educação",
       y = "Taxa de litigiosidade") +
  ggplot2::geom_smooth(
    colour = green_abj,
    se = FALSE,
    method = 'loess',
    formula = y ~ x
  ) +
  ggplot2::facet_wrap( ~ regiao_nm) +
  ggplot2::theme_bw(12)
```

A figura  mostra a taxa de litigiosidade por gini. 


```{r litigiosidade-gini, fig.cap = "Litigiosidade por gini", layout="l-body-outset", eval = TRUE, echo = FALSE, warning = FALSE}
base_litigiosidade %>%
  dplyr::select(taxa, gini, regiao_nm) %>%
  dplyr::filter(taxa > 0) %>%
  ggplot2::ggplot(aes(x = gini, y = taxa, colour = regiao_nm)) +
  ggplot2::geom_point() +
  ggplot2::scale_y_log10() +
  ggplot2::geom_smooth(aes(colour = NULL), se = FALSE, colour = green_abj) +
  ggplot2::scale_colour_viridis_d(begin = .2,
                                  end = .8,
                                  option = "A") +
  labs(x = "Taxa de litigiosidade",
       y = "GINI") +
  ggplot2::theme_minimal(12)
```

um grafico de dispersao agregando por estado (fazer)

## Conclusão